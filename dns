#!/bin/bash

INPUT_FILE="input.txt"
OUTPUT_FILE="resolved_ips.txt"
VSERVER_FILE="vservers_with_zero_ip.txt"

> "$OUTPUT_FILE"
> "$VSERVER_FILE"

grep -oE "10\.81\.[0-9]+\.[0-9]+" "$INPUT_FILE" | while read -r ip; do
    dns_name=$(nslookup "$ip" | awk '/name =/ {print $NF}' | sed 's/\.$//')
    
    if [ -n "$dns_name" ]; then
        echo "$ip - $dns_name" >> "$OUTPUT_FILE"
    else
        echo "$ip - No DNS record" >> "$OUTPUT_FILE"
    fi
done

grep "0.0.0.0" "$INPUT_FILE" | grep -oE "add lb vserver [a-zA-Z0-9\-]+" | grep "^add lb vserver appjava" >> "$VSERVER_FILE"

echo "İşlem tamamlandı."
echo "Çıktı dosyası: $OUTPUT_FILE"
echo "0.0.0.0 IP'leri içeren vserver'lar: $VSERVER_FILE"
